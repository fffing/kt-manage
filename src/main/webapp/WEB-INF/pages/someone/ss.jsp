<%@ page language="java" contentType="text/html; charset=UTF-8"
pageEncoding="UTF-8"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta charset="UTF-8">
<title>框条之家|原木框条</title>
<link rel="stylesheet" href="css/index.css"></link>
<link rel="stylesheet" href="css/response.css"></link>
<link rel="stylesheet" href="css/product_list.css"></link>
<link rel="stylesheet" href="css/bootstrap.min.css"></link>
<link rel="stylesheet" href="css/main.css"></link>
<link rel="stylesheet" href="css/login.css"></link>
<script type="text/javascript" src="js/fenye.js"></script>
<script type="text/javascript" src="js/util.js"></script>
<script type="text/javascript" src="js/v.js"></script>
<script type="text/javascript" src="js/pc_nb.js"></script>

</head>
<body>
	<div class="iBottom">
		<div class="type-content">
			<div class="search-rule active">
				<div class="type-content" style="margin-top: 15px">
					<div class="filter-condition">
						<div class="filter-condition-nav">
							全部结果 <span style="font-family: monospace">&gt;</span>
						</div>

						<div class="filter-select-list"></div>

					</div>
				</div>
				<div class="rule-list">
					<div class="rule-title">品类</div>
					<div class="rule-options typeStr">
						<a href="javascript:;" id="new"
							class=" types">新品</a> <a href="javascript:;"
							data-id="182500900025" data-value="热销" class=" types">热销</a> <a
							href="javascript:;" data-id="182500900026" data-value="促销"
							class=" types">促销</a>
					</div>
				</div>
				<div class="rule-list">
					<div class="rule-title">材质</div>
					<div class="rule-options typeStr">
						<a href="javascript:;" data-id="182500900028" data-value="PS"
							class=" types">PS</a> <a href="javascript:;"
							data-id="182500900029" data-value="实木" class=" types">实木</a> <a
							href="javascript:;" data-id="182500900030" data-value="铝合金"
							class=" types">铝合金</a> <a href="javascript:;"
							data-id="182500900031" data-value="MDF" class=" types">MDF</a>
					</div>
				</div>
				<div class="rule-list">
					<div class="rule-title">功能</div>
					<div class="rule-options typeStr">
						<a href="javascript:;" data-id="182500900032" data-value="画框"
							class=" types">画框</a> <a href="javascript:;"
							data-id="182500900033" data-value="相框" class=" types">相框</a> <a
							href="javascript:;" data-id="182500900034" data-value="镜框"
							class=" types">镜框</a> <a href="javascript:;"
							data-id="182500900035" data-value="婚纱框" class=" types">婚纱框</a>
					</div>
				</div>
				<div class="rule-list">
					<div class="rule-title">形状</div>
					<div class="rule-options typeStr">
						<a href="javascript:;" data-id="182500900036" data-value="平框"
							class=" types">平框</a> <a href="javascript:;"
							data-id="182500900037" data-value="高唇口" class=" types">高唇口</a> <a
							href="javascript:;" data-id="182500900038" data-value="三角形"
							class=" types">三角形</a> <a href="javascript:;"
							data-id="182500900039" data-value="L框" class=" types">L框</a> <a
							href="javascript:;" data-id="182500900040" data-value="内衬线条"
							class=" types">内衬线条</a> <a href="javascript:;"
							data-id="182500900041" data-value="波纹" class=" types">波纹</a> <a
							href="javascript:;" data-id="182500900042" data-value="外弧"
							class=" types">外弧</a> <a href="javascript:;"
							data-id="182500900043" data-value="内凹" class=" types">内凹</a> <a
							href="javascript:;" data-id="182500900044" data-value="其他"
							class=" types">其他</a>
					</div>
				</div>
				<div class="rule-list">
					<div class="rule-title">颜色</div>
					<div class="rule-options typeStr">
						<a href="javascript:;" data-id="182500900045" data-value="白色"
							class=" types">白色</a> <a href="javascript:;"
							data-id="182500900046" data-value="黑色" class=" types">黑色</a> <a
							href="javascript:;" data-id="182500900047" data-value="彩色"
							class=" types">彩色</a> <a href="javascript:;"
							data-id="182500900048" data-value="浅木纹" class=" types">浅木纹</a> <a
							href="javascript:;" data-id="182500900049" data-value="深木纹"
							class=" types">深木纹</a> <a href="javascript:;"
							data-id="182500900050" data-value="水彩木纹" class=" types">水彩木纹</a>
						<a href="javascript:;" data-id="182500900051" data-value="金色"
							class=" types">金色</a> <a href="javascript:;"
							data-id="182500900052" data-value="银色" class=" types">银色</a> <a
							href="javascript:;" data-id="182500900053" data-value="古铜色"
							class=" types">古铜色</a>
					</div>
				</div>
				<div class="rule-list">
					<div class="rule-title">尺寸宽度</div>
					<div class="rule-options typeStr">
						<a href="javascript:;" data-id="182500900054" data-value="尺寸≤3"
							class=" types">尺寸≤3</a> <a href="javascript:;"
							data-id="182500900055" data-value="3&lt;尺寸≤5" class=" types">3&lt;尺寸≤5</a>
						<a href="javascript:;" data-id="182500900056"
							data-value="5&lt;尺寸≤7" class=" types">5&lt;尺寸≤7</a> <a
							href="javascript:;" data-id="182500900057"
							data-value="7&lt;尺寸≤10" class=" types">7&lt;尺寸≤10</a> <a
							href="javascript:;" data-id="182500900058"
							data-value="10&lt;尺寸≤12" class=" types">10&lt;尺寸≤12</a> <a
							href="javascript:;" data-id="182500900059" data-value="12&lt;尺寸"
							class=" types">12&lt;尺寸</a>
					</div>
				</div>
			</div>
		</div>
	</div>
</body>
<script type="text/javascript">
var paramLableIds=$('#paramLableIds').val();
var paramLableIdArr=[];
//回写标签
if(paramLableIds.length){
    paramLableIdArr=paramLableIds.split(',');
    var template='';
    $.each(paramLableIdArr,function(i,ids){
        var children=ids.split('@');
        var $optionsEle=$('.rule-options').find('a[data-id='+children[0]+']').parent();
        var index = $optionsEle.parent().index();
        var title = $.trim($optionsEle.prev().html());
        var content = '';
        $.each(children,function(j,id){
            content += $('a[data-id='+id+']').addClass('active').html() + '、';
        });
        content = content.slice(0, -1);
        template+='<a class="filter-select-item" data-id="'+ids+'" type="' + index + '" title="' + content + '"><b>'+title+'：</b><em>' + content + '</em><i>×</i></a>';
    });
    console.log(template);
    $('.filter-select-list').html(template);
}

//选中标签
var selectItem = $('.rule-options').find('a[data-value]');
selectItem.click(function () {
    $(this).toggleClass('active');
    var html = '';
    $('.rule-options').each(function (i, ele) {
        if ($(ele).children('.active').length) {
            var title = $.trim($(ele).prev().html());

            var index = $(ele).parent().index();
            var content = '';
            var id='';
            $(ele).children('.active').each(function (i, item) {
                content += $(item).html() + '、';
                id+=$(item).attr('data-id')+'@';
            });
            content = content.slice(0, -1);
            id = id.slice(0, -1);
            html += '<a class="filter-select-item" data-id="'+id+'" type="' + index + '" title="' + content + '"><b>' + title + '：</b><em>' + content + '</em><i>×</i></a>';
        }
    });
    $('.filter-select-list').html(html);
    getLabelIds()
});

//删除标签
$('.filter-select-list').on('click', '.filter-select-item i', function () {
    var parent = $(this).parent();
    $('.rule-list').eq(parent.attr('type')).find('a').removeClass('active');
    parent.remove();
    getLabelIds()
});
//获取标签条件
function getLabelIds(){
    var lableIds=$('.filter-select-item').map(function(i,item){
        return $(item).attr('data-id');
    }).get();
    $('#paramLableIds').val(lableIds);
    $('#pageNo').val(1);
    submit()
}

//排序
var sortArr = ['upperTime', 'salev', 'price'];
$('.sort-rule').find('.sort-items').click(function () {

    if ($(this).hasClass('active') && $(this).index() !== 1) {
        $(this).find('i').toggleClass('text-black');
    } else {
        $(this).addClass('active').siblings('.active').removeClass('active');
    }

    var sortOrder = '';
    if ($(this).index() !== 1) {
        if ($(this).find('i.text-black').hasClass('glyphicon-triangle-top')) {
            sortOrder = 'desc'
        } else {
            sortOrder = 'asc'
        }
    } else {
        sortOrder = 'desc'
    }

    $('#sortName').val(sortArr[$(this).index()]);
    $('#sortOrder').val(sortOrder);
    submit();
});
$('#stock').change(function(){
    submit();
});

//分页
$('.pagination').find('a[page]').click(function(){
   $('#pageNo').val($(this).attr('page'));
    submit();
});
//跳转明细
$('.product-image').click(function () {
    var proId=$(this).attr("product_id");
    var proName=$(this).attr("product_name");
    //var newWindow = window.open();
    $.ajaxSettings.async = false;
    $.post("/product/category?id="+proId,null,function(data){
        var category = data;
        //location.href="/"+category+"/"+proName+".html";
        window.open("/"+category+"/"+proName+".html");
    });
    $.ajaxSettings.async = true;
});

var form=$('#product-list-form');
form.attr('action',location.pathname);
//提交表单
function submit(){
    form.find('input').each(function(i,item){
       if($(item).val()){
           $(item).attr('name',$(item).attr('id'));
       }else{
           $(item).removeAttr('name');
       }
    });

    form.submit();
}
$(function() {
	doLoadUI("#new", "kt/findById");
})
function doLoadUI(id, url) {
	var params={id=3};
	$(id).click(function() {
		$.post(url,params,function(){
			$(".iBottom").html("").load(url, function() {
				$(".iBottom").removeData();
			});
		})
	});
};
</script>
</html>